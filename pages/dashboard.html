<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Fanscore</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="../styles/dashboard.css">
    <link rel="stylesheet" href="../styles/globals.css">
    <link rel="stylesheet" href="../styles/layout.css">
    <link rel="stylesheet" href="../styles/components.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div id="app">
    <app-layout
        :menu-items="sidebarMenu"
        :user="userProfile"
        :stats="profileStats"
        :actions="profileActions"
        :topbar="topbarConfig"
        :search-value="searchQuery"
        @logout="handleLogout"
        @action-click="handleProfileAction"
        @topbar-action="handleTopbarAction"
        @search="handleSearch"
    >
        <!-- üéâ Banner -->
        <div class="banner">
          <div class="banner-text">
            <h2>¬°Completa tu √Ålbum!</h2>
            <p>Colecciona todas las estampitas y participa por premios exclusivos. Cada sobre contiene 5 estampitas aleatorias.</p>
            <button @click="openPackModal" :disabled="!canOpenPack" class="banner-button">
              <i class="fas fa-gift"></i> Abrir Sobre ({{ packsAvailable }} disponibles)
            </button>
          </div>
        </div>

        <!-- üìä Secci√≥n de estad√≠sticas y jugador destacado -->
        <div class="dashboard-grid">
            <!-- Estad√≠sticas - Ocupa 2/3 -->
            <section class="stats">
                <div class="stat-card">
                    <span class="stat-icon"><i class="fas fa-stamp"></i></span>
                    <h3>Cromos Obtenidos</h3>
                    <p>{{ collectedStickers }}/{{ totalStickers }}</p>
                </div>
                <div class="stat-card">
                    <span class="stat-icon"><i class="fas fa-chart-pie"></i></span>
                    <h3>Progreso del √Ålbum</h3>
                    <p>{{ progressPercentage }}%</p>
                </div>
                <div class="stat-card">
                    <span class="stat-icon"><i class="fas fa-gift"></i></span>
                    <h3>Sobres Disponibles</h3>
                    <p>{{ packsAvailable }}</p>
                </div>
                <div class="stat-card">
                    <span class="stat-icon"><i class="fas fa-exchange-alt"></i></span>
                    <h3>Intercambios</h3>
                    <p>{{ exchanges }}</p>
                </div>
            </section>
            
            <!-- Jugador Destacado - Ocupa 1/3 -->
            <section class="top-player">
                <h2><i class="fas fa-crown"></i> Jugador Destacado</h2>
                <div class="player-featured">
                    <div class="player-card-featured">
                        <div class="player-img-featured">
                            <i class="fas fa-user"></i>
                            <div class="player-rating">{{ featuredPlayer.rating }}</div>
                        </div>
                        <div class="player-info-featured">
                            <h3>{{ featuredPlayer.name }}</h3>
                            <p class="player-position">{{ featuredPlayer.position }} ‚Ä¢ {{ featuredPlayer.team }}</p>
                            <div class="player-stats-featured">
                                <div class="stat-featured">
                                    <div class="stat-value">{{ featuredPlayer.overall }}</div>
                                    <div class="stat-label">Overall</div>
                                </div>
                                <div class="stat-featured">
                                    <div class="stat-value">{{ featuredPlayer.votes }}</div>
                                    <div class="stat-label">Votos</div>
                                </div>
                                <div class="stat-featured">
                                    <div class="stat-value">{{ featuredPlayer.approval }}%</div>
                                    <div class="stat-label">Aprobaci√≥n</div>
                                </div>
                            </div>
                            <div class="player-badges">
                                <span class="badge" v-for="badge in featuredPlayer.badges" :key="badge">
                                    <i :class="badge.icon"></i> {{ badge.text }}
                                </span>
                            </div>
                            <button class="vote-btn" @click="voteForPlayer(featuredPlayer.id)">
                                <i class="fas fa-check"></i> Votar ahora
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- üë• Jugadores destacados -->
        <section class="featured-players">
            <h2>Jugadores Destacados</h2>
            <div class="players-grid">
                <div class="player-card" v-for="player in topPlayers" :key="player.id">
                    <div class="player-img">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="player-info">
                        <h3>{{ player.name }}</h3>
                        <p>{{ player.position }} ‚Ä¢ {{ player.team }}</p>
                        <div class="player-stats">
                            <div class="stat">
                                <div class="stat-value">{{ player.overall }}</div>
                                <div class="stat-label">Overall</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value">{{ player.stickers }}</div>
                                <div class="stat-label">Cromos</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value">{{ player.rating }}</div>
                                <div class="stat-label">Rating</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- üì∞ Noticias -->
        <section class="news">
            <h2>Noticias Destacadas</h2>
            <div class="news-cards">
                <article class="news-card" v-for="newsItem in news" :key="newsItem.id" @click="openNews(newsItem.id)">
                    <h3>{{ newsItem.title }}</h3>
                    <p>{{ newsItem.description }}</p>
                    <div class="news-meta">
                        <span class="news-date">{{ newsItem.date }}</span>
                        <span class="news-category">{{ newsItem.category }}</span>
                    </div>
                </article>
            </div>
        </section>
      
    </app-layout>
  </div>

  <!-- Incluir componentes -->
  <script src="../components/sidebar-component.js"></script>
  <script src="../components/profile-component.js"></script>
  <script src="../components/layout-component.js"></script>
  <script src="../components/topbar-component.js"></script>
  
  <script>
// SearchComponent para el topbar
const SearchComponent = {
  template: `
    <div class="search-container">
      <i class="fas fa-search"></i>
      <input 
        type="text" 
        :placeholder="placeholder"
        :value="modelValue"
        @input="$emit('update:modelValue', $event.target.value)"
      >
    </div>
  `,
  props: {
    placeholder: {
      type: String,
      default: 'Buscar...'
    },
    modelValue: {
      type: String,
      default: ''
    }
  },
  emits: ['update:modelValue']
};

const { createApp, ref, computed } = Vue;

const app = createApp({
  setup() {
    // Datos reactivos del dashboard
    const searchQuery = ref('');
    const packsAvailable = ref(3);
    const exchanges = ref(12);
    const toasts = ref([]);

    // Datos del √°lbum para el dashboard
    const totalStickers = ref(20);
    const collectedStickers = ref(13);
    const duplicateStickers = computed(() => {
      // En un caso real, esto vendr√≠a de tu base de datos
      return 12;
    });
    
    // Computed properties del dashboard
    const progressPercentage = computed(() => Math.round((collectedStickers.value / totalStickers.value) * 100));
    const canOpenPack = computed(() => packsAvailable.value > 0);

    // Jugador destacado
    const featuredPlayer = ref({
      id: 1,
      name: 'Kylian Mbapp√©',
      position: 'Delantero',
      team: 'Francia',
      rating: 9.4,
      overall: 91,
      votes: 4892,
      approval: 98,
      badges: [
        { icon: 'fas fa-trophy', text: 'Mejor jugador' },
        { icon: 'fas fa-star', text: 'M√°s votado' }
      ]
    });

    // Jugadores top
    const topPlayers = ref([
      {
        id: 1,
        name: 'Lionel Messi',
        position: 'Delantero',
        team: 'Argentina',
        overall: 94,
        stickers: 12,
        rating: 4.8
      },
      {
        id: 2,
        name: 'Kylian Mbapp√©',
        position: 'Delantero',
        team: 'Francia',
        overall: 91,
        stickers: 8,
        rating: 4.6
      },
      {
        id: 3,
        name: 'Pedri Gonz√°lez',
        position: 'Centrocampista',
        team: 'Espa√±a',
        overall: 86,
        stickers: 5,
        rating: 4.5
      }
    ]);

    // Noticias del dashboard
    const news = ref([
      {
        id: 1,
        title: '‚öΩ Sorteo oficial del Mundial confirmado',
        description: 'El sorteo de grupos para el Mundial 2026 se realizar√° el pr√≥ximo mes en una ceremonia especial.',
        date: 'Hace 2 d√≠as',
        category: 'Eventos'
      },
      {
        id: 2,
        title: 'üåç M√©xico, USA y Canad√° listos como anfitriones',
        description: 'Los tres pa√≠ses anfitriones ultiman detalles para recibir a las selecciones y aficionados.',
        date: 'Hace 5 d√≠as',
        category: 'Organizaci√≥n'
      },
      {
        id: 3,
        title: 'üî• J√≥venes promesas que brillar√°n en 2026',
        description: 'Conoce a los futbolistas j√≥venes que est√°n destinados a destacar en el pr√≥ximo Mundial.',
        date: 'Ayer',
        category: 'Jugadores'
      }
    ]);

    // M√©todos del dashboard
    const openPackModal = () => {
      if (canOpenPack.value) {
        console.log('üéÅ Abriendo modal de sobres...');
        showToast('Redirigiendo a la p√°gina de sobres...', 'info');
        // Aqu√≠ ir√≠a la l√≥gica para abrir el modal o redirigir
      } else {
        showToast('No tienes sobres disponibles', 'error');
      }
    };

    const voteForPlayer = (playerId) => {
      console.log('Votando por el jugador:', playerId);
      featuredPlayer.value.votes++;
      showToast('¬°Voto registrado! Gracias por participar.', 'success');
    };

    const openNews = (newsId) => {
      console.log('Abriendo noticia:', newsId);
      showToast(`Abriendo noticia: ${news.find(n => n.id === newsId)?.title}`, 'info');
    };

    // Sistema de notificaciones toast (igual que en √°lbum)
    const showToast = (message, type = 'info') => {
      const id = Date.now();
      toasts.value.push({ id, message, type });
      
      // Auto-remover despu√©s de 5 segundos
      setTimeout(() => {
        removeToast(id);
      }, 5000);
    };

    const removeToast = (id) => {
      toasts.value = toasts.value.filter(toast => toast.id !== id);
    };

    const getToastIcon = (type) => {
      const icons = {
        success: 'fas fa-check-circle',
        error: 'fas fa-exclamation-circle',
        warning: 'fas fa-exclamation-triangle',
        info: 'fas fa-info-circle'
      };
      return icons[type] || 'fas fa-info-circle';
    };

    // Menu del sidebar - Dashboard activo
    const sidebarMenu = ref([
      { name: 'Dashboard', link: 'dashboard.html', icon: 'fas fa-home', active: true },
      { name: '√Ålbum', link: 'album.html', icon: 'fas fa-book', active: false },
      { name: 'Enciclopedia', link: 'enciclopedia.html', icon: 'fas fa-globe', active: false },
    ]);

    // Perfil del usuario
    const userProfile = ref({
      avatar: 'https://i.pinimg.com/736x/22/20/56/2220563187a6e72782c5e9ead2287ec5.jpg',
      username: '@UsuarioFan',
      level: 15
    });

    // Stats del perfil - COMPUTED como en √°lbum
    const profileStats = computed(() => [
      { 
        label: '√Ålbum', 
        value: `${progressPercentage.value}% completado`,
        icon: 'fas fa-chart-pie'
      },
      { 
        label: 'Cromos', 
        value: `${collectedStickers.value}/${totalStickers.value}`,
        icon: 'fas fa-stamp'
      },
      { 
        label: 'Duplicados', 
        value: `${duplicateStickers.value}`,
        icon: 'fas fa-copy'
      },
      { 
        label: 'Sobres', 
        value: `${packsAvailable.value}`,
        icon: 'fas fa-gift'
      },
     /* { 
        label: 'Intercambios', 
        value: `${exchanges.value}`,
        icon: 'fas fa-exchange-alt'
      },
      { 
        label: 'Nivel', 
        value: `${userProfile.value.level}`,
        icon: 'fas fa-star'
      }*/
    ]);

    // Acciones del perfil mejoradas
    const profileActions = ref([
      { 
        name: 'Mi Perfil', 
        icon: 'fas fa-user',
        description: 'Ver tu perfil completo'
      },
      { 
        name: 'Intercambios', 
        icon: 'fas fa-exchange-alt',
        description: 'Gestionar intercambios'
      }
    ]);

    // Topbar config actualizada
    const topbarConfig = ref({
      searchPlaceholder: 'Buscar jugadores, equipos, noticias...',
      actions: [
        { 
          name: 'notifications', 
          icon: 'fas fa-bell', 
          title: 'Notificaciones',
          badge: 3
        },
        /*
        { 
          name: 'messages', 
          icon: 'fas fa-envelope', 
          title: 'Mensajes',
          badge: 1
        },
        */
        { 
          name: 'settings', 
          icon: 'fas fa-cog', 
          title: 'Configuraci√≥n' 
        }
      ]
    });

    // M√©todos del layout actualizados
    const handleLogout = () => {
      console.log('Cerrando sesi√≥n...');
      showToast('Cerrando sesi√≥n...', 'info');
    };

    const handleProfileAction = (action) => {
      console.log('Acci√≥n perfil:', action);
      switch(action.name) {
        case 'Mi Perfil':
          showToast('Redirigiendo a tu perfil...', 'info');
          break;
        case 'Intercambios':
          showToast('Abriendo intercambios...', 'info');
          break;
        case 'Logros':
          showToast('Mostrando logros...', 'info');
          break;
        case 'Configuraci√≥n':
          showToast('Abriendo configuraci√≥n...', 'info');
          break;
      }
    };

    const handleTopbarAction = (action) => {
      console.log('Acci√≥n topbar:', action);
      switch(action.name) {
        case 'notifications':
          showToast('Mostrando notificaciones...', 'info');
          break;
        case 'messages':
          showToast('Abriendo mensajes...', 'info');
          break;
        case 'settings':
          showToast('Abriendo configuraci√≥n...', 'info');
          break;
      }
    };

    const handleSearch = (value) => {
      console.log('Buscando:', value);
      if (value.length > 2) {
        showToast(`Buscando: "${value}"`, 'info');
      }
    };

    return {
      // Datos
      searchQuery,
      packsAvailable,
      exchanges,
      totalStickers,
      collectedStickers,
      featuredPlayer,
      topPlayers,
      news,
      toasts,
      
      // Computed
      progressPercentage,
      canOpenPack,
      duplicateStickers,
      
      // Datos del layout
      sidebarMenu,
      userProfile,
      profileStats,
      profileActions,
      topbarConfig,
      
      // M√©todos
      openPackModal,
      voteForPlayer,
      openNews,
      showToast,
      removeToast,
      getToastIcon,
      handleLogout,
      handleProfileAction,
      handleTopbarAction,
      handleSearch
    };
  }
});

// ====================
// REGISTRAR COMPONENTES
// ====================

// Componentes globales
app.component('sidebar-main', SidebarComponent);
app.component('profile-sidebar', ProfileComponent);
app.component('app-layout', LayoutComponent);
app.component('topbar-component', TopbarComponent);
app.component('search-component', SearchComponent);

app.mount('#app');
  </script>
</body>
</html>